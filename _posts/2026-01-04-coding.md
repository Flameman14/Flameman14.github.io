---
title: ëŒ€ì™¸í™œë™ìš© ì½”ë“œ ì‘ì„±   # ê¸€ ì œëª©
date: 2026-01-04 18:00:00 +0900 # ì‘ì„± ë‚ ì§œ (í˜•ì‹ ì§€í‚¬ ê²ƒ!)
categories: [ëŒ€ì™¸í™œë™, AIì½”ë”©]        # [ëŒ€ë¶„ë¥˜, ì†Œë¶„ë¥˜] (ëŒ€ë¶„ë¥˜ë§Œ ì¨ë„ ë¨)
tags: [ëŒ€ì™¸í™œë™, AIì½”ë”©, ì—‘ì…€]     # íƒœê·¸ (ì†Œë¬¸ìë¡œ ì“°ëŠ” ê²Œ ì¢‹ìŒ)
---
<br>

## ë§Œë“¤ê²Œ ëœ ê³„ê¸°
ëŒ€ì™¸í™œë™ì—ì„œ ê³µëª¨ì „ì„ ì—´ì—ˆìŠµë‹ˆë‹¤. \
ë§ì€ ì‹ ì²­ìë“¤ì´ ë“¤ì–´ì™€ ìˆ˜ê¸° ì‘ì„±ì´ë‚˜ ê¸°ì–µë ¥ë§Œ ë¯¿ê¸°ì—ëŠ” ëˆ„ë½ì˜ ìœ„í—˜ê³¼ ì •ë³´ ê³µìœ ì˜ í•œê³„ê°€ ìˆì„ ê²ƒ ê°™ì•„ ìë™í™” ì‹œìŠ¤í…œì„ ë§Œë“¤ê³ ì í•˜ì˜€ìŠµë‹ˆë‹¤. <br><br>

### ì œì¶œ ì‹ ì²­ì„œ ë¶„ë¥˜ ì‹œíŠ¸

ì²«ë²ˆì§¸ë¡œ ë§Œë“¤ê³ ì í•œ ì‹œìŠ¤í…œì€ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ë¥¼ í™œìš©í•˜ì—¬ ë¬¸ì„œë¥¼ ë‘ ì¢…ë¥˜ë¡œ ë‚˜ëˆ„ëŠ” ê²ƒì…ë‹ˆë‹¤. \
ìŠ¹ì¸ ì‹œìŠ¤í…œì´ë¼ê³  ìƒê°í•˜ë©´ ë©ë‹ˆë‹¤.\
ê°„ë‹¨í•œ ë°©ì‹ì´ë¼ ê·¸ë‹¤ì§€ ìˆ˜ì •í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.  <br>

ê¸°ì¡´ì—ëŠ” ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ íŒŒì¼ì„ ê°€ì ¸ì˜¤ê³  ë°°ë¶„ í›„ ìˆ˜ë™ìœ¼ë¡œ ì •ë¦¬í•˜ëŠ” ì‹œìŠ¤í…œì´ì—ˆìœ¼ë‚˜, íŠ¸ë¦¬ê±° ê¸°ëŠ¥ì„ í™œìš©í•˜ì—¬ í™”ë©´ì´ ì—´ë¦´ ì‹œ ìë™ìœ¼ë¡œ ë¶ˆëŸ¬ì˜¤ë„ë¡ ë°©ì‹ì„ ë°”ê¾¸ì—ˆìŠµë‹ˆë‹¤. <br> <br>



```markdown
## ìµœì‹  ë²„ì „ (v2.0)
ì§€ê¸ˆ ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥í•œ ì½”ë“œì…ë‹ˆë‹¤.

```javascript
// =======================================================
// [ì„¤ì • 1] í´ë” ID ì„¤ì •
var SOURCE_FOLDER_ID = 'ë¯¸ë¶„ë¥˜ íŒŒì¼ í´ë” ID'; 
var TARGET_FOLDER_A_ID = 'ì•„ì´ë””ì–´ ì œì¶œ íŒŒì¼ í´ë” ID';
var TARGET_FOLDER_B_ID = 'ì œì¶œ ë° ì‹¤í–‰ íŒŒì¼ í´ë” ID';

// [ì„¤ì • 2] í‰ê°€í‘œ ì‹œíŠ¸ ID ì„¤ì • (ì—¬ê¸°ì— ë³µì‚¬í•œ IDë¥¼ ë„£ìœ¼ì„¸ìš”!)
var EVALUATION_SHEET_ID = 'ë¶„ë¥˜í•œ íŒŒì¼ì„ í‰ê°€í‘œ ì‹œíŠ¸ë¡œ ì´ë™í•˜ê¸° ìœ„í•œ ë¶€ë¶„'; 
// =======================================================

function onOpen() {
  var ui = SpreadsheetApp.getUi();
  ui.createMenu('ğŸ“‚ íŒŒì¼ ì •ë¦¬ ë„êµ¬')
    .addItem('1. ë¯¸ë¶„ë¥˜ íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°', 'loadUnsortedFiles')
    .addItem('2. ì„ íƒí•œëŒ€ë¡œ ì´ë™ & í‰ê°€í‘œ ë“±ë¡', 'moveFilesBasedOnSelection')
    .addSeparator()
    .addItem('3. (ìˆ˜ë™) í‰ê°€í‘œ ë™ê¸°í™”', 'syncToEvaluationSheet')
    .addToUi();
}

// 1. ë¯¸ë¶„ë¥˜ íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸° (ê¸°ì¡´ ë™ì¼)
function loadUnsortedFiles() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  cleanUpEmptyRows(sheet); // ë¹ˆ ì¤„ ì •ë¦¬

  var folder = DriveApp.getFolderById(SOURCE_FOLDER_ID);
  var files = folder.getFiles();
  
  var lastRow = sheet.getLastRow();
  var existingIds = [];
  if (lastRow > 1) {
    var data = sheet.getRange(2, 5, lastRow - 1, 1).getValues(); 
    existingIds = data.map(function(row) { return row[0]; });
  }

  var newCount = 0;
  // ë¶„ë¥˜ ì„ íƒ ë“œë¡­ë‹¤ìš´
  var rule = SpreadsheetApp.newDataValidation()
    .requireValueInList(['ì•„ì´ë””ì–´ ì œì¶œ', 'ì œì¶œ ë° ì‹¤í–‰'], true).setAllowInvalid(false).build();

  while (files.hasNext()) {
    var file = files.next();
    var fileId = file.getId();
    
    if (existingIds.indexOf(fileId) === -1) {
      sheet.appendRow([file.getName(), file.getUrl(), "", "ëŒ€ê¸°", fileId]);
      sheet.getRange(sheet.getLastRow(), 3).setDataValidation(rule);
      newCount++;
    }
  }
  
  var msg = newCount > 0 ? newCount + 'ê°œì˜ íŒŒì¼ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.' : 'ìƒˆë¡œìš´ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.';
  SpreadsheetApp.getUi().alert(msg);
}

// ë¹ˆ ì¤„ ì •ë¦¬ í•¨ìˆ˜
function cleanUpEmptyRows(sheet) {
  var lastRow = sheet.getLastRow();
  for (var i = lastRow; i >= 2; i--) {
    var rowData = sheet.getRange(i, 1, 1, 5).getValues()[0];
    if (rowData[0] === "" && rowData[4] === "") {
      sheet.deleteRow(i);
    }
  }
}

// 2. íŒŒì¼ ì´ë™ + í‰ê°€í‘œ ë“±ë¡ê¹Œì§€ í•œ ë²ˆì— ì‹¤í–‰
function moveFilesBasedOnSelection() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var data = sheet.getDataRange().getValues(); 
  var folderA = DriveApp.getFolderById(TARGET_FOLDER_A_ID);
  var folderB = DriveApp.getFolderById(TARGET_FOLDER_B_ID);
  
  var movedCount = 0;

  for (var i = 1; i < data.length; i++) {
    var category = data[i][2]; 
    var fileId = data[i][4];   
    
    if (category != "" && fileId != "") {
      try {
        var file = DriveApp.getFileById(fileId);
        
        if (category == "ì•„ì´ë””ì–´ ì œì¶œ") {
          file.moveTo(folderA);
          sheet.getRange(i + 1, 4).setValue("ì´ë™ì™„ë£Œ"); 
          sheet.getRange(i + 1, 1, 1, 5).setBackground("#FFF2CC"); 
          movedCount++;
        } else if (category == "ì œì¶œ ë° ì‹¤í–‰") {
          file.moveTo(folderB);
          sheet.getRange(i + 1, 4).setValue("ì´ë™ì™„ë£Œ");
          sheet.getRange(i + 1, 1, 1, 5).setBackground("#D9EAD3"); 
          movedCount++;
        }
      } catch (e) {
        sheet.getRange(i + 1, 4).setValue("ì—ëŸ¬: " + e.message);
      }
    }
  }
  
  if (movedCount > 0) {
    // ì´ë™ì´ ëë‚¬ìœ¼ë©´ í‰ê°€í‘œë¡œ ì •ë³´ ì „ì†¡
    syncToEvaluationSheet(); 
    SpreadsheetApp.getUi().alert('íŒŒì¼ ì´ë™ ë° í‰ê°€í‘œ ë“±ë¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');
  } else {
    SpreadsheetApp.getUi().alert('ì´ë™í•  íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.');
  }
}

// 3. [í•µì‹¬] í‰ê°€í‘œ ì‹œíŠ¸ì— ìë™ìœ¼ë¡œ ë‚´ìš© ì¶”ê°€ ë° ì„œì‹ ì ìš© í•¨ìˆ˜
function syncToEvaluationSheet() {
  var sourceSheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var sourceData = sourceSheet.getDataRange().getValues();
  
  // í‰ê°€í‘œ íŒŒì¼ ì—´ê¸°
  try {
    var targetSpreadsheet = SpreadsheetApp.openById(EVALUATION_SHEET_ID);
  } catch (e) {
    SpreadsheetApp.getUi().alert('í‰ê°€í‘œ ì‹œíŠ¸ IDê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤. ìŠ¤í¬ë¦½íŠ¸ ë§¨ ìœ„ ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
    return;
  }
  
  var targetSheet = targetSpreadsheet.getSheets()[0]; // ì²« ë²ˆì§¸ ì‹œíŠ¸ ì‚¬ìš©
  var targetHeaders = targetSheet.getRange("1:1").getValues()[0]; // 1í–‰(í—¤ë”) ê°€ì ¸ì˜¤ê¸°
  
  var addedCount = 0;

  // ì†ŒìŠ¤ ë°ì´í„° ìŠ¤ìº” (2í–‰ë¶€í„°)
  for (var i = 1; i < sourceData.length; i++) {
    var fileName = sourceData[i][0]; // Aì—´: íŒŒì¼ ì´ë¦„
    var fileUrl = sourceData[i][1];  // Bì—´: ë§í¬
    var status = sourceData[i][3];   // Dì—´: ìƒíƒœ
    
    // 'ì´ë™ì™„ë£Œ' ìƒíƒœì¸ íŒŒì¼ë§Œ ì²˜ë¦¬
    if (status === "ì´ë™ì™„ë£Œ") {
      // ì´ë¯¸ í‰ê°€í‘œì— ìˆëŠ”ì§€ ì´ë¦„ìœ¼ë¡œ í™•ì¸ (ì¤‘ë³µ ë°©ì§€)
      // ì •í™•í•œ ë§¤ì¹­ì„ ìœ„í•´ íŒŒì¼ ì´ë¦„ì´ 1í–‰ì— ìˆëŠ”ì§€ í™•ì¸
      var exists = false;
      for (var k = 0; k < targetHeaders.length; k++) {
        if (targetHeaders[k] === fileName) { // ì´ë¦„ì´ ë˜‘ê°™ìœ¼ë©´ ì´ë¯¸ ìˆëŠ” ê²ƒìœ¼ë¡œ ê°„ì£¼
          exists = true;
          break;
        }
      }
      
      // í‰ê°€í‘œì— ì—†ìœ¼ë©´ ìƒˆë¡œ ì¶”ê°€
      if (!exists) {
        var newCol = targetSheet.getLastColumn() + 1; // ìƒˆë¡œìš´ ì—´ ë²ˆí˜¸
        
        // 1í–‰ì— [ë§í¬ê°€ ê±¸ë¦° ì´ë¦„] ë„£ê¸°
        var formula = '=HYPERLINK("' + fileUrl + '", "' + fileName + '")';
        targetSheet.getRange(1, newCol).setFormula(formula);
        
        // â˜… í‰ê°€í‘œ ì„œì‹ ë° ë“œë¡­ë‹¤ìš´ ìë™ ì ìš© (ì›ê²© ì œì–´) â˜…
        applyEvaluationFormat(targetSheet, newCol);
        
        addedCount++;
        // í—¤ë” ë°°ì—´ ì—…ë°ì´íŠ¸ (ë°©ê¸ˆ ì¶”ê°€í•œ ê²ƒë„ ì¤‘ë³µ ì²´í¬ì— ë°˜ì˜)
        targetHeaders.push(fileName);
      }
    }
  }
}

// í‰ê°€í‘œ ì„œì‹ ì ìš© í•¨ìˆ˜ (ì´ì „ì— ë§Œë“  ê¹”ë”í•œ ë²„ì „)
function applyEvaluationFormat(sheet, col) {
  var dropdownRows = [3, 4, 5, 6, 9, 10, 11, 14, 15, 17, 20, 21];
  var totalRow = 19;

  // ë“œë¡­ë‹¤ìš´ (O/X)
  var rule = SpreadsheetApp.newDataValidation()
    .requireValueInList(['O', 'X'], true).setAllowInvalid(false).build();
  
  dropdownRows.forEach(function(row) {
    sheet.getRange(row, col).setDataValidation(rule);
  });

  // ì´ì  ìˆ˜ì‹ (=COUNTIF)
  var colLetter = getColumnLetter(col);
  var formulaStr = '=COUNTIF(' + colLetter + '3:' + colLetter + '17, "O")';
  sheet.getRange(totalRow, col).setFormula(formulaStr);

  // ë””ìì¸ (ì´ì ë§Œ ë…¸ë€ìƒ‰)
  sheet.getRange(totalRow, col)
       .setBackground("#FFF2CC")
       .setFontWeight("bold")
       .setHorizontalAlignment("center");
       
  // ì „ì²´ ê°€ìš´ë° ì •ë ¬ (ì„ íƒì‚¬í•­)
  sheet.getRange(3, col, 19, 1).setHorizontalAlignment("center");
}

// ì—´ ë²ˆí˜¸ -> ì•ŒíŒŒë²³ ë³€í™˜
function getColumnLetter(colIndex) {
  var temp, letter = '';
  while (colIndex > 0) {
    temp = (colIndex - 1) % 26;
    letter = String.fromCharCode(temp + 65) + letter;
    colIndex = (colIndex - temp - 1) / 26;
  }
  return letter;
}
```
<br><br>

### í‰ê°€í‘œ ì‹œíŠ¸ 

í‰ê°€í‘œ ì‹œíŠ¸ëŠ” ì—¬ëŸ¬ë²ˆ ìˆ˜ì •í•˜ì˜€ìŠµë‹ˆë‹¤.\
ì²˜ìŒì—ëŠ” ë‹¨ìˆœíˆ í‰ê°€ë§Œ í•˜ëŠ” ì‹œíŠ¸ë¡œ ì‚¬ìš©í–ˆì§€ë§Œ, ì´í›„ ê°œì¸ í‰ê°€ ë° íŒ€ ì „ì› í‰ê°€, ìµœì¢… ìŠ¹ì¸ì„ ìœ„í•œ ë³´ê³ ì„œ ì—­í• ë„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ ìˆ˜ì •ì— ìˆ˜ì •ì„ ê±°ë“­í•˜ì˜€ìŠµë‹ˆë‹¤. \
í¬ê²Œ 3ê°€ì§€ ì˜ì—­ìœ¼ë¡œ êµ¬ë¶„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. <br><br>


<details>
<summary>1. ì´ˆê¸° ë²„ì „ (v1.0)</summary>
  
<br>

ì²˜ìŒì—ëŠ” ë‹¨ìˆœí•œ í‰ê°€ìš© ì‹œíŠ¸ì˜€ìŠµë‹ˆë‹¤. ì œì¶œ ì‹ ì²­ì„œ ë¶„ë¥˜ ì‹œíŠ¸ì—ì„œ íŒŒì¼ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ê³ , í‰ê°€ë¥¼ ìœ„í•´ O, X ë“œë¡­ë‹¤ìš´ê³¼ í•©ì‚° ê¸°ëŠ¥ì„ ìë™ ìƒì„±í•˜ë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤.

```markdown

```javascript

function updateEvaluationListCountO() {
  // ==========================================
  // 1. ê¸°ë³¸ ì„¤ì • (ì‚¬ìš©ì í™˜ê²½ì— ë§ê²Œ ìˆ˜ì •)
  // ==========================================
  var FOLDER_ID = "ì•„ì´ë””ì–´ ì œì¶œ í´ë”ID"; // í”„ë¡œì íŠ¸ íŒŒì¼ì´ ìˆëŠ” êµ¬ê¸€ ë“œë¼ì´ë¸Œ í´ë” ID
  var targetSheets = ["í‰ê°€ì1", "í‰ê°€ì2", "í‰ê°€ì3"];   // í‰ê°€ë¥¼ ì§„í–‰í•  ì‹œíŠ¸ ì´ë¦„ ëª©ë¡
  
  // â–¼ ì´ë¯¸ì§€ ê¸°ì¤€ 'O' ì²´í¬ê°€ í•„ìš”í•œ í–‰ ë²ˆí˜¸ (ì´ 10ê°œ í•­ëª©)
  // ê³µìµì„±(3,4,5,6) + ì‹¤í˜„ê°€ëŠ¥ì„±(10,11,12) + ì°½ì˜ì„±(16,17) + ì§€ì†ê°€ëŠ¥ì„±(20)
  var ROWS_TO_CHECK = [3, 4, 5, 6, 10, 11, 12, 16, 17, 20]; 

  // ==========================================
  // 2. ë©”ì¸ ë¡œì§ ì‹œì‘
  // ==========================================
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var folder, files;

  try {
    folder = DriveApp.getFolderById(FOLDER_ID);
    files = folder.getFiles();
  } catch (e) {
    ss.toast("âŒ í´ë” IDë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”. í´ë”ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
    return;
  }
  
  // ë“œë¼ì´ë¸Œ íŒŒì¼ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
  var fileList = [];
  while (files.hasNext()) {
    var file = files.next();
    fileList.push({ name: file.getName(), url: file.getUrl() });
  }

  if (fileList.length === 0) {
    ss.toast("ğŸ“‚ ì§€ì •ëœ í´ë”ì— íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.");
    return;
  }

  // ê° ì‹œíŠ¸(í‰ê°€ì) ë³„ë¡œ ìˆœíšŒ
  targetSheets.forEach(function(sheetName) {
    var sheet = ss.getSheetByName(sheetName);
    if (!sheet) return; // í•´ë‹¹ ì´ë¦„ì˜ ì‹œíŠ¸ê°€ ì—†ìœ¼ë©´ ê±´ë„ˆëœ€

    // ì‹œíŠ¸ì˜ ë§ˆì§€ë§‰ í–‰ ê³„ì‚° (ìµœì†Œ 30í–‰ í™•ë³´)
    var lastRow = sheet.getLastRow();
    if (lastRow < 30) lastRow = 30; 

    // ê¸°ì¡´ì— ì´ë¯¸ ì¶”ê°€ëœ íŒ€ í™•ì¸ (ì¤‘ë³µ ì¶”ê°€ ë°©ì§€)
    var lastCol = sheet.getLastColumn();
    var existingTeams = [];
    if (lastCol > 1) {
      // 1í–‰(í—¤ë”)ì— ìˆëŠ” íŒ€ëª…ë“¤ì„ ê°€ì ¸ì˜´
      existingTeams = sheet.getRange(1, 2, 1, lastCol - 1).getValues()[0]; 
    }

    // Aì—´ì„ ìŠ¤ìº”í•˜ì—¬ 'ì´í•©' í–‰ê³¼ 'ë°œí‘œ' í–‰ì˜ ìœ„ì¹˜ë¥¼ ë™ì ìœ¼ë¡œ ì°¾ìŒ
    var colA = sheet.getRange(1, 1, lastRow, 1).getValues(); 
    var rowTotal = -1; 
    var rowPick = -1;

    for (var i = 0; i < colA.length; i++) {
      var val = String(colA[i][0]);
      if (val.indexOf("ì´í•©") !== -1) rowTotal = i + 1; // 'ì´í•©'ì´ í¬í•¨ëœ í–‰ (ì´ë¯¸ì§€ìƒ 23í–‰ ì˜ˆìƒ)
      if (val.indexOf("ë°œí‘œ") !== -1 || val.indexOf("ê´€ê³„ ì—†ì´") !== -1) rowPick = i + 1; // 'ë°œí‘œ' ê´€ë ¨ í–‰ (ì´ë¯¸ì§€ìƒ 24í–‰ ì˜ˆìƒ)
    }
    
    // í˜¹ì‹œ Aì—´ í…ìŠ¤íŠ¸ë¥¼ ëª» ì°¾ì„ ê²½ìš°ë¥¼ ëŒ€ë¹„í•œ ê¸°ë³¸ê°’ (ì´ë¯¸ì§€ ê¸°ì¤€)
    if (rowTotal === -1) rowTotal = 23; 
    if (rowPick === -1) rowPick = 24;

    var addedCount = 0;

    // íŒŒì¼ ë¦¬ìŠ¤íŠ¸ì™€ ê¸°ì¡´ íŒ€ì„ ë¹„êµí•˜ì—¬ ì—†ëŠ” íŒ€ë§Œ ì¶”ê°€
    fileList.forEach(function(fileInfo) {
      if (existingTeams.indexOf(fileInfo.name) == -1) {
        lastCol = sheet.getLastColumn(); 
        var newCol = lastCol + 1;
        
        // (1) Bì—´(ê¸°ì¤€ ì„œì‹) ë³µì‚¬ 
        // -> ë“œë¡­ë‹¤ìš´, í…Œë‘ë¦¬, ë°°ê²½ìƒ‰ ë“± ì„œì‹ì„ ê·¸ëŒ€ë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤.
        var sourceRange = sheet.getRange(2, 2, lastRow - 1, 1);
        var destRange = sheet.getRange(2, newCol);
        sourceRange.copyTo(destRange); 
        
        // (2) ë‚´ìš©ì€ ì§€ìš°ê³  ì„œì‹ë§Œ ìœ ì§€ (ê¹¨ë—í•œ ìƒíƒœë¡œ ì‹œì‘)
        sheet.getRange(2, newCol, lastRow - 1, 1).clearContent();

        // (3) í—¤ë”: íŒ€ëª… ì¶”ê°€ ë° íŒŒì¼ ë§í¬ ì—°ê²°
        var headerCell = sheet.getRange(1, newCol);
        var rule = SpreadsheetApp.newRichTextValue()
          .setText(fileInfo.name)
          .setLinkUrl(fileInfo.url)
          .build();
        headerCell.setRichTextValue(rule);
        headerCell.setFontWeight("bold");
        headerCell.setHorizontalAlignment("center");
        headerCell.setBackground(null); 

        // (4) [í•µì‹¬] ì´ì  ìˆ˜ì‹ ì ìš©
        // ë‹¨ìˆœ ìˆ«ìê°€ ì•„ë‹Œ, ê° í•­ëª©ì˜ 'O' ê°œìˆ˜ë¥¼ ì„¸ëŠ” ìˆ˜ì‹ì„ ì…€ì— ì…ë ¥í•©ë‹ˆë‹¤.
        // ì˜ˆ: =COUNTIF(C3,"O") + COUNTIF(C4,"O") + ...
        var totalCell = sheet.getRange(rowTotal, newCol);
        
        var countFormulaParts = ROWS_TO_CHECK.map(function(r) {
          var cellAddr = sheet.getRange(r, newCol).getA1Notation();
          return 'COUNTIF(' + cellAddr + ', "O")';
        });
        
        var formulaString = "=" + countFormulaParts.join("+");
        
        totalCell.setFormula(formulaString); // ìˆ˜ì‹ ì…ë ¥
        totalCell.setBackground("#fff2cc");  // ë…¸ë€ìƒ‰ ë°°ê²½ ê°•ì¡°
        totalCell.setFontWeight("bold");
        totalCell.setHorizontalAlignment("center");
        totalCell.setNumberFormat("0");      // ì •ìˆ˜ í‘œì‹œ

        // (5) ë°œí‘œ ë“£ê³  ì‹¶ì€ê°€? (O/X ë“œë¡­ë‹¤ìš´ ì„¤ì •)
        var pickCell = sheet.getRange(rowPick, newCol);
        var ruleOX = SpreadsheetApp.newDataValidation()
          .requireValueInList(['O', 'X'], true)
          .setAllowInvalid(false)
          .build();
        pickCell.setDataValidation(ruleOX);
        pickCell.setHorizontalAlignment("center");

        addedCount++;
      }
    });
    
    if (addedCount > 0) {
      ss.toast(sheetName + " ì‹œíŠ¸ì— " + addedCount + "ê°œ íŒ€ ì—…ë°ì´íŠ¸ ì™„ë£Œ!");
    }
  });
}
```
</details>

<details markdown="1">

<summary>2. ìˆ˜ì • ë²„ì „ (v2.0)</summary>

<br>
ë‹¨ìˆœíˆ ì ìˆ˜ í•©ì‚°ì„ ìœ„í•œ ì‹œíŠ¸ê°€ ì•„ë‹Œ 'ìŠˆí¼íŒ¨ìŠ¤'ë¥¼ êµ¬ë¶„í•˜ê¸° ìœ„í•œ ì‹œíŠ¸ë¡œ ì‚¬ìš©í•˜ê³ ì í•˜ì˜€ìŠµë‹ˆë‹¤<br>
ì ìˆ˜ì˜ ì´í•©ì´ ë†’ì€ ì•„ì´ë””ì–´ë³´ë‹¤, ë°œí‘œë¥¼ ë“£ê³ ì‹¶ì€ ì‹ ë°•í•œ ì•„ì´ë””ì–´ì— ë” ê¸°íšŒë¥¼ ì£¼ê³ ì í•˜ì—¬ 'ìŠˆí¼íŒ¨ìŠ¤' ì¹¸ì„ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.<br>
ë˜í•œ íŠ¸ë¦¬ê±°ë¥¼ ì‚¬ìš©í•˜ê¸° ì‹œì‘í•˜ì˜€ìŠµë‹ˆë‹¤. <br>

ì´ë•Œë¶€í„° ì½”ë“œê°€ í¬ê²Œ ì„¸ê°€ì§€ì˜€ì§€ë§Œ ê°€ì¥ ë³€í™”ê°€ ì¦ì•˜ë˜ 3ë²ˆë§Œì„ ì‘ì„±í•©ë‹ˆë‹¤. <br>
ë‹¤ë¥¸ ì½”ë“œëŠ” í˜„ì¬ ì‚¬ìš©í•˜ëŠ” ê²ƒê³¼ ìœ ì‚¬í•©ë‹ˆë‹¤.



```markdown

```javascript

/**
 * 3. ìµœì¢… ê²°ê³¼ ì§‘ê³„ ê¸°ëŠ¥ (í‰ê°€ ì‹œíŠ¸)
 * - [ë””ìì¸ ìˆ˜ì •] ìˆœìœ„í‘œ ì œëª©(K1)ì„ L1, M1ê¹Œì§€ ë³‘í•©í•˜ì—¬ ìƒ‰ì¹ 
 * - [ë””ìì¸ ìˆ˜ì •] ìŠˆí¼íŒ¨ìŠ¤ ì œëª©(O1)ì„ R1ê¹Œì§€ ë³‘í•©í•˜ì—¬ ìƒ‰ì¹ 
 * - ì‹¤í–‰ íŒ€ ìë™ ì´ˆë¡ìƒ‰ í‘œì‹œ ê¸°ëŠ¥ í¬í•¨
 */
function updateFinalDashboard() {
  var evaluators = ["í‰ê°€ì1", "í‰ê°€ì2", "í‰ê°€ì3"]; 
  var summarySheetName = "í‰ê°€ ì‹œíŠ¸"; 
  var SCORE_ROW = 23; 
  var VOTE_ROW = 24; 

  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getSheetByName(summarySheetName);

  if (!sheet) {
    ss.toast("âŒ '" + summarySheetName + "' ì‹œíŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.");
    return;
  }

  var fileList = getAllProjectFiles();
  if (fileList.length === 0) {
    ss.toast("ğŸ“‚ ê°€ì ¸ì˜¬ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.");
    return;
  }

  // ì´ˆê¸°í™”
  sheet.clear(); 
  
  // (A) ì „ì²´ ë°ì´í„° í—¤ë”
  var headers = ["íŒ€ëª…", "ë§í¬", "í‰ê°€ì1(ì )", "í‰ê°€ì2(ì )", "í‰ê°€ì3(ì )", "ì´ì (30)", "í‰ê°€ì1(í”½)", "í‰ê°€ì2(í”½)", "í‰ê°€ì3(í”½)", "êµ¬ë¶„"];
  sheet.getRange(1, 1, 1, headers.length).setValues([headers])
    .setFontWeight("bold").setBackground("#f3f3f3").setHorizontalAlignment("center");

  // ë°ì´í„° ì±„ìš°ê¸°
  var startRow = 2;
  
  fileList.forEach(function(team, index) {
    var r = startRow + index;
    
    // 1. íŒ€ëª… & ë§í¬
    sheet.getRange(r, 1).setValue(team.name);
    if (team.isExec) sheet.getRange(r, 1).setBackground("#d9ead3"); // ì‹¤í–‰íŒ€ ë°°ê²½ìƒ‰

    var linkRule = SpreadsheetApp.newRichTextValue().setText("ì´ë™").setLinkUrl(team.url).build();
    sheet.getRange(r, 2).setRichTextValue(linkRule).setHorizontalAlignment("center");

    // 2. ì ìˆ˜
    evaluators.forEach(function(evalName, i) {
      var formulaScore = "=IFERROR(HLOOKUP($A" + r + ", '" + evalName + "'!$1:$30, " + SCORE_ROW + ", 0), 0)";
      sheet.getRange(r, 3 + i).setFormula(formulaScore).setNumberFormat("0");
    });

    // 3. ì´ì 
    sheet.getRange(r, 6).setFormula("=SUM(C" + r + ":E" + r + ")");

    // 4. ë°œí‘œ í”½
    evaluators.forEach(function(evalName, i) {
      var formulaVote = "=IFERROR(HLOOKUP($A" + r + ", '" + evalName + "'!$1:$30, " + VOTE_ROW + ", 0), \"X\")";
      sheet.getRange(r, 7 + i).setFormula(formulaVote).setHorizontalAlignment("center");
    });

    // 5. ì‹¤í–‰íŒ€ ì—¬ë¶€ ë§ˆí‚¹ (Jì—´, ìˆ¨ê¹€ ì²˜ë¦¬ë¨)
    if (team.isExec) {
      sheet.getRange(r, 10).setValue("EXEC");
    } else {
      sheet.getRange(r, 10).setValue("GEN");
    }
  });
  
  // í…Œë‘ë¦¬ ë° Jì—´ ìˆ¨ê¸°ê¸°
  var lastDataRow = startRow + fileList.length - 1;
  sheet.getRange(1, 1, lastDataRow, headers.length).setBorder(true, true, true, true, true, true);
  sheet.hideColumns(10); 

  // ==========================================
  // (B) ğŸ† ì¢…í•© ìˆœìœ„í‘œ (ë””ìì¸ ìˆ˜ì •ë¨)
  // ==========================================
  var rankHeaderRow = 1;
  var rankColStart = 11; // Kì—´

  // [ìˆ˜ì •] K1ë¶€í„° M1ê¹Œì§€(3ì¹¸) í•©ì¹˜ê³  ìƒ‰ì¹ í•˜ê¸°
  sheet.getRange(rankHeaderRow, rankColStart, 1, 3)
       .merge() // ì…€ ë³‘í•©
       .setValue("ğŸ† ì¢…í•© ìˆœìœ„ (Top List)")
       .setFontWeight("bold").setFontSize(12)
       .setBackground("#fff2cc")
       .setHorizontalAlignment("center");
  
  sheet.getRange(rankHeaderRow + 1, rankColStart).setValue("ìˆœìœ„");
  sheet.getRange(rankHeaderRow + 1, rankColStart + 1).setValue("íŒ€ëª…");
  sheet.getRange(rankHeaderRow + 1, rankColStart + 2).setValue("ì´ì  (30)");

  var queryFormula = "=QUERY(A2:F, \"SELECT A, F WHERE A IS NOT NULL ORDER BY F DESC\", 0)";
  sheet.getRange(rankHeaderRow + 2, rankColStart + 1).setFormula(queryFormula);
  sheet.getRange(rankHeaderRow + 2, rankColStart).setFormula("=SEQUENCE(COUNTA(L3:L))");


  // ==========================================
  // (C) ğŸ« ìŠˆí¼íŒ¨ìŠ¤ (ë””ìì¸ ìˆ˜ì •ë¨)
  // ==========================================
  var passColStart = 15; // Oì—´

  // [ìˆ˜ì •] O1ë¶€í„° R1ê¹Œì§€(4ì¹¸) í•©ì¹˜ê³  ìƒ‰ì¹ í•˜ê¸°
  sheet.getRange(rankHeaderRow, passColStart, 1, 4)
       .merge() // ì…€ ë³‘í•©
       .setValue("ğŸ« ìŠˆí¼íŒ¨ìŠ¤ í›„ë³´ (ë°œí‘œ O ìˆìŒ)")
       .setFontWeight("bold").setFontSize(12)
       .setBackground("#d9ead3")
       .setHorizontalAlignment("center");

  var filterFormula = "=IFERROR(FILTER({A2:A, G2:I}, (G2:G=\"O\") + (H2:H=\"O\") + (I2:I=\"O\")), \"(ë°œí‘œ O ë°›ì€ íŒ€ ì—†ìŒ)\")";
  sheet.getRange(rankHeaderRow + 2, passColStart).setFormula(filterFormula);
  
  var passHeaders = ["íŒ€ëª…", "í‰ê°€ì1", "í‰ê°€ì2", "í‰ê°€ì3"];
  sheet.getRange(rankHeaderRow + 1, passColStart, 1, 4).setValues([passHeaders])
       .setFontWeight("bold").setBackground("#efefef").setHorizontalAlignment("center");


  // ==========================================
  // (D) ì¡°ê±´ë¶€ ì„œì‹ (ì‹¤í–‰íŒ€ ì´ˆë¡ìƒ‰ í‘œì‹œ)
  // ==========================================
  var rangeRankName = sheet.getRange("L4:L"); 
  var rangePassName = sheet.getRange("O4:O"); 
  
  var formula = '=VLOOKUP(L4, $A$2:$J, 10, 0)="EXEC"'; 
  var formulaPass = '=VLOOKUP(O4, $A$2:$J, 10, 0)="EXEC"';

  var ruleRank = SpreadsheetApp.newConditionalFormatRule()
    .whenFormulaSatisfied(formula)
    .setBackground("#d9ead3") 
    .setRanges([rangeRankName])
    .build();

  var rulePass = SpreadsheetApp.newConditionalFormatRule()
    .whenFormulaSatisfied(formulaPass)
    .setBackground("#d9ead3") 
    .setRanges([rangePassName])
    .build();

  var rules = sheet.getConditionalFormatRules();
  rules.push(ruleRank);
  rules.push(rulePass);
  sheet.setConditionalFormatRules(rules);

  ss.toast("âœ… ë””ìì¸ ìˆ˜ì • ì™„ë£Œ! (í—¤ë” ë³‘í•©ë¨)");
}



```
</details>



3. ìµœì¢… ë²„ì „ (v3.0)

ë‘ë²ˆì§¸ ë²„ì „ë„ êµ‰ì¥íˆ ì˜ ì‚¬ìš©í•˜ê³  ìˆì—ˆìœ¼ë‚˜, ê° íŒ€ì— ëŒ€í•´ ë©”ëª¨í•´ë‘” ë‚´ìš©ì´ í˜ì´ì§€ë¥¼ ì¬ì‹¤í–‰í•˜ë©´ ì „ë¶€ ì‚¬ë¼ì§€ëŠ” ë¬¸ì œê°€ ìˆì–´ì„œ ì´ë¥¼ ìˆ˜ì •í•˜ì˜€ìŠµë‹ˆë‹¤. 

```markdown

```javascript
/**
 * 1. ë©”ë‰´ ìƒì„±
 */
function onOpen() {
  var ui = SpreadsheetApp.getUi();
  ui.createMenu('ğŸ† ê³µëª¨ì „ í‰ê°€ ê´€ë¦¬')
      .addItem('1. íŒ€ ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ (ê°œë³„ ì‹œíŠ¸)', 'updateEvaluationListCountO')
      .addItem('2. ìµœì¢… ê²°ê³¼ ì§‘ê³„ (í‰ê°€ ì‹œíŠ¸)', 'updateFinalDashboard')
      .addToUi();
}

/**
 * [ê³µí†µ í•¨ìˆ˜] ëª¨ë“  í´ë”(ì¼ë°˜+ì‹¤í–‰)ì—ì„œ íŒŒì¼ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
 */
function getAllProjectFiles() {
  // â–¼ í´ë” ID ì„¤ì • (ë³¸ì¸ì˜ í´ë” IDë¡œ ìˆ˜ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”)
  var GENERAL_FOLDER_ID = "ì•„ì´ë””ì–´ ì œì¶œ íŒŒì¼ í´ë” ID"; // ì¼ë°˜ íŒ€ í´ë”
  var EXEC_FOLDER_ID = "ì œì¶œ ë° ì‹¤í–‰ íŒŒì¼ í´ë” ID";    // ì‹¤í–‰ íŒ€ í´ë”

  var list = [];
  
  function scanFolder(folderId, isExec) {
    try {
      var folder = DriveApp.getFolderById(folderId);
      var files = folder.getFiles();
      while (files.hasNext()) {
        var file = files.next();
        list.push({ 
          name: file.getName(), 
          url: file.getUrl(), 
          isExec: isExec 
        });
      }
    } catch (e) {
      console.log("í´ë” ì ‘ì† ì‹¤íŒ¨: " + folderId);
    }
  }

  scanFolder(GENERAL_FOLDER_ID, false); 
  scanFolder(EXEC_FOLDER_ID, true);     

  return list;
}

/**
 * 2. ê°œë³„ í‰ê°€ ì‹œíŠ¸ ì—…ë°ì´íŠ¸
 */
function updateEvaluationListCountO() {
  var targetSheets = ["í‰ê°€ì1", "í‰ê°€ì2", "í‰ê°€ì3"]; 
  var ROWS_TO_CHECK = [3, 4, 5, 6, 10, 11, 12, 16, 17, 20]; 

  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var allFiles = getAllProjectFiles();

  if (allFiles.length === 0) {
    ss.toast("ğŸ“‚ ê°€ì ¸ì˜¬ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤. í´ë” IDë¥¼ í™•ì¸í•˜ì„¸ìš”.");
    return;
  }

  targetSheets.forEach(function(sheetName) {
    var sheet = ss.getSheetByName(sheetName);
    if (!sheet) return;

    var lastRow = sheet.getLastRow();
    if (lastRow < 30) lastRow = 30; 

    // ê¸°ì¡´ íŒ€ í™•ì¸
    var lastCol = sheet.getLastColumn();
    var existingTeams = [];
    if (lastCol > 1) {
      existingTeams = sheet.getRange(1, 2, 1, lastCol - 1).getValues()[0]; 
    }

    // í–‰ ìœ„ì¹˜ ì°¾ê¸°
    var colA = sheet.getRange(1, 1, lastRow, 1).getValues(); 
    var rowTotal = 23; 
    var rowPick = 24;

    for (var i = 0; i < colA.length; i++) {
      var val = String(colA[i][0]);
      if (val.indexOf("ì´í•©") !== -1 && val.indexOf("ì˜ê²¬") === -1) rowTotal = i + 1;
      if (val.indexOf("ë°œí‘œ") !== -1 || val.indexOf("ê´€ê³„ ì—†ì´") !== -1) rowPick = i + 1;
    }

    var addedCount = 0;

    allFiles.forEach(function(fileInfo) {
      if (existingTeams.indexOf(fileInfo.name) == -1) {
        lastCol = sheet.getLastColumn(); 
        var newCol = lastCol + 1;
        
        var sourceRange = sheet.getRange(2, 2, lastRow - 1, 1);
        sourceRange.copyTo(sheet.getRange(2, newCol)); 
        
        sheet.getRange(2, newCol, lastRow - 1, 1).clearContent();

        var headerCell = sheet.getRange(1, newCol);
        var rule = SpreadsheetApp.newRichTextValue().setText(fileInfo.name).setLinkUrl(fileInfo.url).build();
        headerCell.setRichTextValue(rule).setFontWeight("bold").setHorizontalAlignment("center");
        
        // ì‹¤í–‰ íŒ€ ë°°ê²½ìƒ‰
        if (fileInfo.isExec) headerCell.setBackground("#d9ead3");
        else headerCell.setBackground(null);

        // ì´ì  ìˆ˜ì‹
        var totalCell = sheet.getRange(rowTotal, newCol);
        var countFormulaParts = ROWS_TO_CHECK.map(function(r) {
          return 'COUNTIF(' + sheet.getRange(r, newCol).getA1Notation() + ', "O")';
        });
        totalCell.setFormula("=" + countFormulaParts.join("+"))
                 .setBackground("#fff2cc").setFontWeight("bold").setHorizontalAlignment("center");

        // ë°œí‘œ OX
        var pickCell = sheet.getRange(rowPick, newCol);
        var ruleOX = SpreadsheetApp.newDataValidation().requireValueInList(['O', 'X'], true).build();
        pickCell.setDataValidation(ruleOX).setHorizontalAlignment("center");
        
        if (fileInfo.isExec) pickCell.setValue("O");
        else pickCell.setValue("");

        addedCount++;
      }
    });
    
    if (addedCount > 0) ss.toast(sheetName + " ì‹œíŠ¸: " + addedCount + "ê°œ íŒ€ ì¶”ê°€ ì™„ë£Œ!");
  });
}

/**
 * 3. ìµœì¢… ê²°ê³¼ ì§‘ê³„ ê¸°ëŠ¥ (í‰ê°€ ì‹œíŠ¸)
 * - [ìˆ˜ì •] ì‹œíŠ¸ ì „ì²´ ì´ˆê¸°í™”(clear) ì œê±° -> í•„ìš”í•œ ë¶€ë¶„ë§Œ ì§€ìš°ë„ë¡ ë³€ê²½
 * - ì´ì œ Sì—´ ì˜†ì— ì ì–´ë‘” ë©”ëª¨ê°€ ë‚ ì•„ê°€ì§€ ì•ŠìŠµë‹ˆë‹¤.
 */
function updateFinalDashboard() {
  var evaluators = ["í‰ê°€ì1", "í‰ê°€ì2", "í‰ê°€ì3"]; 
  var summarySheetName = "í‰ê°€ ì‹œíŠ¸"; 
  var SCORE_ROW = 23; 
  var VOTE_ROW = 24; 

  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getSheetByName(summarySheetName);

  if (!sheet) {
    ss.toast("âŒ '" + summarySheetName + "' ì‹œíŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.");
    return;
  }

  var fileList = getAllProjectFiles();
  if (fileList.length === 0) {
    ss.toast("ğŸ“‚ ê°€ì ¸ì˜¬ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.");
    return;
  }

  // ==========================================
  // [ì¤‘ìš”] ì „ì²´ ì‚­ì œ(sheet.clear()) ëŒ€ì‹ , ì‚¬ìš©í•˜ëŠ” ì—´ë§Œ ê³¨ë¼ì„œ ì§€ì›ë‹ˆë‹¤.
  // ê·¸ë˜ì•¼ Sì—´ ì´í›„ì— ì ì–´ë‘” ë©”ëª¨ê°€ ë³´ì¡´ë©ë‹ˆë‹¤.
  // ==========================================
  var maxRows = sheet.getMaxRows();
  
  // 1. ì „ì²´ ë°ì´í„° ì˜ì—­ ì§€ìš°ê¸° (Aì—´ ~ Jì—´)
  sheet.getRange(1, 1, maxRows, 10).clear(); 
  
  // 2. ì¢…í•© ìˆœìœ„í‘œ ì˜ì—­ ì§€ìš°ê¸° (Kì—´ ~ Mì—´)
  sheet.getRange(1, 11, maxRows, 3).clear();

  // 3. ìŠˆí¼íŒ¨ìŠ¤ ì˜ì—­ ì§€ìš°ê¸° (Oì—´ ~ Rì—´)
  sheet.getRange(1, 15, maxRows, 4).clear();

  // 4. ì¡°ê±´ë¶€ ì„œì‹ ì´ˆê¸°í™” (ê·œì¹™ì´ ì¤‘ë³µìœ¼ë¡œ ìŒ“ì´ëŠ” ê²ƒ ë°©ì§€)
  sheet.clearConditionalFormatRules();


  // ==========================================
  // (A) ì „ì²´ ë°ì´í„° ì±„ìš°ê¸°
  // ==========================================
  var headers = ["íŒ€ëª…", "ë§í¬", "í‰ê°€ì1(ì )", "í‰ê°€ì2(ì )", "í‰ê°€ì3(ì )", "ì´ì (30)", "í‰ê°€ì1(í”½)", "í‰ê°€ì2(í”½)", "í‰ê°€ì3(í”½)", "êµ¬ë¶„"];
  sheet.getRange(1, 1, 1, headers.length).setValues([headers])
    .setFontWeight("bold").setBackground("#f3f3f3").setHorizontalAlignment("center");

  var startRow = 2;
  
  fileList.forEach(function(team, index) {
    var r = startRow + index;
    
    // 1. íŒ€ëª… & ë§í¬
    sheet.getRange(r, 1).setValue(team.name);
    if (team.isExec) sheet.getRange(r, 1).setBackground("#d9ead3"); 

    var linkRule = SpreadsheetApp.newRichTextValue().setText("ì´ë™").setLinkUrl(team.url).build();
    sheet.getRange(r, 2).setRichTextValue(linkRule).setHorizontalAlignment("center");

    // 2. ì ìˆ˜
    evaluators.forEach(function(evalName, i) {
      var formulaScore = "=IFERROR(HLOOKUP($A" + r + ", '" + evalName + "'!$1:$30, " + SCORE_ROW + ", 0), 0)";
      sheet.getRange(r, 3 + i).setFormula(formulaScore).setNumberFormat("0");
    });

    // 3. ì´ì 
    sheet.getRange(r, 6).setFormula("=SUM(C" + r + ":E" + r + ")");

    // 4. ë°œí‘œ í”½
    evaluators.forEach(function(evalName, i) {
      var formulaVote = "=IFERROR(HLOOKUP($A" + r + ", '" + evalName + "'!$1:$30, " + VOTE_ROW + ", 0), \"X\")";
      sheet.getRange(r, 7 + i).setFormula(formulaVote).setHorizontalAlignment("center");
    });

    // 5. ì‹¤í–‰íŒ€ ì—¬ë¶€ ë§ˆí‚¹ (Jì—´)
    if (team.isExec) {
      sheet.getRange(r, 10).setValue("EXEC");
    } else {
      sheet.getRange(r, 10).setValue("GEN");
    }
  });
  
  // í…Œë‘ë¦¬ ë° Jì—´ ìˆ¨ê¸°ê¸°
  var lastDataRow = startRow + fileList.length - 1;
  sheet.getRange(1, 1, lastDataRow, headers.length).setBorder(true, true, true, true, true, true);
  sheet.hideColumns(10); 


  // ==========================================
  // (B) ğŸ† ì¢…í•© ìˆœìœ„í‘œ
  // ==========================================
  var rankHeaderRow = 1;
  var rankColStart = 11; // Kì—´

  sheet.getRange(rankHeaderRow, rankColStart, 1, 3)
       .merge()
       .setValue("ğŸ† ì¢…í•© ìˆœìœ„ (Top List)")
       .setFontWeight("bold").setFontSize(12)
       .setBackground("#fff2cc")
       .setHorizontalAlignment("center");
  
  sheet.getRange(rankHeaderRow + 1, rankColStart).setValue("ìˆœìœ„");
  sheet.getRange(rankHeaderRow + 1, rankColStart + 1).setValue("íŒ€ëª…");
  sheet.getRange(rankHeaderRow + 1, rankColStart + 2).setValue("ì´ì  (30)");

  var queryFormula = "=QUERY(A2:F, \"SELECT A, F WHERE A IS NOT NULL ORDER BY F DESC\", 0)";
  sheet.getRange(rankHeaderRow + 2, rankColStart + 1).setFormula(queryFormula);
  sheet.getRange(rankHeaderRow + 2, rankColStart).setFormula("=SEQUENCE(COUNTA(L3:L))");


  // ==========================================
  // (C) ğŸ« ìŠˆí¼íŒ¨ìŠ¤
  // ==========================================
  var passColStart = 15; // Oì—´

  sheet.getRange(rankHeaderRow, passColStart, 1, 4)
       .merge()
       .setValue("ğŸ« ìŠˆí¼íŒ¨ìŠ¤ í›„ë³´ (ë°œí‘œ O ìˆìŒ)")
       .setFontWeight("bold").setFontSize(12)
       .setBackground("#d9ead3")
       .setHorizontalAlignment("center");

  var filterFormula = "=IFERROR(FILTER({A2:A, G2:I}, (G2:G=\"O\") + (H2:H=\"O\") + (I2:I=\"O\")), \"(ë°œí‘œ O ë°›ì€ íŒ€ ì—†ìŒ)\")";
  sheet.getRange(rankHeaderRow + 2, passColStart).setFormula(filterFormula);
  
  var passHeaders = ["íŒ€ëª…", "ê¹€ìˆ˜ì•„", "ì„ ì„œì˜", "í™ì€ë³„"];
  sheet.getRange(rankHeaderRow + 1, passColStart, 1, 4).setValues([passHeaders])
       .setFontWeight("bold").setBackground("#efefef").setHorizontalAlignment("center");


  // ==========================================
  // (D) ì¡°ê±´ë¶€ ì„œì‹
  // ==========================================
  var rangeRankName = sheet.getRange("L4:L"); 
  var rangePassName = sheet.getRange("O4:O"); 
  
  var formula = '=VLOOKUP(L4, $A$2:$J, 10, 0)="EXEC"'; 
  var formulaPass = '=VLOOKUP(O4, $A$2:$J, 10, 0)="EXEC"';

  var ruleRank = SpreadsheetApp.newConditionalFormatRule()
    .whenFormulaSatisfied(formula)
    .setBackground("#d9ead3") 
    .setRanges([rangeRankName])
    .build();

  var rulePass = SpreadsheetApp.newConditionalFormatRule()
    .whenFormulaSatisfied(formulaPass)
    .setBackground("#d9ead3") 
    .setRanges([rangePassName])
    .build();

  var rules = sheet.getConditionalFormatRules();
  rules.push(ruleRank);
  rules.push(rulePass);

  sheet.setConditionalFormatRules(rules);

  ss.toast("âœ… ì—…ë°ì´íŠ¸ ì™„ë£Œ! (ìˆ˜ê¸° ë©”ëª¨ ë³´ì¡´ë¨)");
}

```

## ê²°ë¡ 

ê³µëª¨ì „ ê²°ê³¼ ë°œí‘œê°€ 1ì›” ì¤‘ìœ¼ë¡œ ëë‚˜ë¯€ë¡œ, ê·¸ ì´ì „ê¹Œì§€ ìš”ê¸´í•˜ê²Œ ì‚¬ìš©í•˜ë©° í¸ì˜ì„±ì´ ë–¨ì–´ì§€ëŠ” ë¶€ë¶„ì€ ê³„ì† ìˆ˜ì •í•´ ê°ˆ ìƒê°ì…ë‹ˆë‹¤. 
